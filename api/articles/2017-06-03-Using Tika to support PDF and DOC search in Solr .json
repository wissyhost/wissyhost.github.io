{"title":"使用tika在solr中支持pdf 和 doc搜索","slug":"2017-06-03-Using Tika to support PDF and DOC search in Solr ","date":"2017-06-02T16:00:00.000Z","updated":"2019-12-08T16:56:55.000Z","comments":false,"path":"api/articles/2017-06-03-Using Tika to support PDF and DOC search in Solr .json","excerpt":"下载solr1<br>https://mirrors.tuna.tsinghua.edu.cn/apache/lucene/solr/6.5.1/solr-6.5.1.tgz<br>点击去Solr主页配置一个普通的solr core1<br>2<br>3<br>4<br>5<br>6<br>7<br>wget https://mirrors.tuna.tsinghua.edu.cn/apache/lucene/solr/6.5.1/solr-6.5.1.tgz # 已下载请忽略<br><br>tar xzvf solr-6.5.1.tgz #解压<br><br>cd solr-6.5.1/server/solr<br><br>cp -r  configsets/basic_configs ./mytestconf # 复制配置文件<br>solr6 支持动态字段添加，不需要配置schema.xml文件到此为止，一个普通的solr core配置完毕了","covers":["/static/images/2017-06-03/solr-add-core-20170603161114.png","/static/images/2017-06-03/solr-exec-data-import20170603154455.png","/static/images/2017-06-03/solr-search-20170603154351.png"],"content":"<link rel=\"stylesheet\" href=\"/assets/css/hint.min.css\"></link><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css\"><div class=\".article-gallery\" <h2 id=\"下载solr\"><a href=\"#下载solr\" class=\"headerlink\" title=\"下载solr\"></a>下载solr<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://mirrors.tuna.tsinghua.edu.cn/apache/lucene/solr/6.5.1/solr-6.5.1.tgz</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"http://lucene.apache.org/solr/\" target=\"_blank\" rel=\"noopener\">点击去Solr主页</a></p>\n<h2 id=\"配置一个普通的solr-core\"><a href=\"#配置一个普通的solr-core\" class=\"headerlink\" title=\"配置一个普通的solr core\"></a>配置一个普通的solr core</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://mirrors.tuna.tsinghua.edu.cn/apache/lucene/solr/6.5.1/solr-6.5.1.tgz <span class=\"comment\"># 已下载请忽略</span></span><br><span class=\"line\"></span><br><span class=\"line\">tar xzvf solr-6.5.1.tgz <span class=\"comment\">#解压</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cd</span> solr-6.5.1/server/solr</span><br><span class=\"line\"></span><br><span class=\"line\">cp -r  configsets/basic_configs ./mytestconf <span class=\"comment\"># 复制配置文件</span></span><br></pre></td></tr></table></figure>\n\n<pre><code>solr6 支持动态字段添加，不需要配置schema.xml文件</code></pre><p>到此为止，一个普通的solr core配置完毕了</p>\n<a id=\"more\"></a>\n<h2 id=\"配置一个支持pdf解析的solr-core\"><a href=\"#配置一个支持pdf解析的solr-core\" class=\"headerlink\" title=\"配置一个支持pdf解析的solr core\"></a>配置一个支持pdf解析的solr core</h2><ul>\n<li>复制配置文件<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp -r  configsets/basic_configs ./mypdfconf</span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n<ul>\n<li><p>复制需要的依赖包</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp -r ../../contrib/extraction/lib ./mypdfconf/ </span><br><span class=\"line\">cp ../../dist/solr-dataimporthandler-* ./mypdfconf/lib/</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>编辑solrconfig配置文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim mypdfconf/conf/solrconfig.xml</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>添加依赖配置到94行</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">lib</span> <span class=\"attr\">dir</span>=<span class=\"string\">\"./lib\"</span> <span class=\"attr\">regex</span>=<span class=\"string\">\".*\\.jar\"</span> /&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>配置dataimport到860行</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">requestHandler</span> <span class=\"attr\">name</span>=<span class=\"string\">\"/dataimport\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"solr.DataImportHandler\"</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">lst</span> <span class=\"attr\">name</span>=<span class=\"string\">\"defaults\"</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">str</span> <span class=\"attr\">name</span>=<span class=\"string\">\"config\"</span>&gt;</span>tika-data-config.xml<span class=\"tag\">&lt;/<span class=\"name\">str</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">lst</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">requestHandler</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>配置 tika-data-config.xml</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim tika-data-config.xml</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>添加以下内容</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">dataConfig</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span>&lt;![CDATA[</span><br><span class=\"line\">        id = 1;</span><br><span class=\"line\"><span class=\"actionscript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">GenerateId</span><span class=\"params\">(row)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">            row.put(<span class=\"string\">'id'</span>, (id ++).toFixed());</span></span><br><span class=\"line\"><span class=\"actionscript\">            <span class=\"keyword\">return</span> row;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"><span class=\"actionscript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">WipOffHtml</span><span class=\"params\">(row)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">            <span class=\"keyword\">var</span> file = row.get(<span class=\"string\">'file'</span>);</span></span><br><span class=\"line\"><span class=\"actionscript\">            row.put(<span class=\"string\">'file'</span>,file.substr(<span class=\"number\">0</span>,file.indexOf(<span class=\"string\">'.'</span>)));</span></span><br><span class=\"line\"><span class=\"actionscript\">            <span class=\"keyword\">return</span> row;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">       ]]&gt;</span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">dataSource</span> <span class=\"attr\">type</span>=<span class=\"string\">\"BinFileDataSource\"</span> /&gt;</span></span><br><span class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">document</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">entity</span>    <span class=\"attr\">name</span>=<span class=\"string\">\"files\"</span> <span class=\"attr\">dataSource</span>=<span class=\"string\">\"binary\"</span>    <span class=\"attr\">rootEntity</span>=<span class=\"string\">\"false\"</span></span></span><br><span class=\"line\"><span class=\"tag\">               <span class=\"attr\">processor</span>=<span class=\"string\">\"FileListEntityProcessor\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">baseDir</span>=<span class=\"string\">\"/tmp/pdfs\"</span> <span class=\"attr\">fileName</span>=<span class=\"string\">\".*.(doc)|(pdf)|(xls)|(ppt)|(docx)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">recursive</span>=<span class=\"string\">\"true\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"fileAbsolutePath\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"filePath\"</span> /&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"fileSize\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"size\"</span> /&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"fileLastModified\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"lastModified\"</span> /&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entity</span>  <span class=\"attr\">name</span>=<span class=\"string\">\"documentImport\"</span>  <span class=\"attr\">processor</span>=<span class=\"string\">\"TikaEntityProcessor\"</span>  <span class=\"attr\">url</span>=<span class=\"string\">\"$&#123;files.fileAbsolutePath&#125;\"</span> <span class=\"attr\">format</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">transformer</span>=<span class=\"string\">\"HTMLStripTransformer,RegexTransformer,script:GenerateId\"</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"file\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"fileName\"</span>/&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span> <span class=\"attr\">column</span>=<span class=\"string\">\"id\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"id\"</span> /&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"Author\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"author\"</span> <span class=\"attr\">meta</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"title\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"title\"</span> <span class=\"attr\">meta</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">stripHTML</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">regex</span>=<span class=\"string\">\"\\t|\\r|\\n|\\s\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                    <span class=\"attr\">replaceWith</span>=<span class=\"string\">\"\"</span> /&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">entity</span>&gt;</span></span><br><span class=\"line\">              <span class=\"tag\">&lt;/<span class=\"name\">entity</span>&gt;</span></span><br><span class=\"line\">           <span class=\"tag\">&lt;/<span class=\"name\">document</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dataConfig</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>添加pdf，doc文档（非扫描版）</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp ../../../../example/exampledocs/solr-word.pdf /tmp/pdfs/</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h2 id=\"添加core\"><a href=\"#添加core\" class=\"headerlink\" title=\"添加core\"></a>添加core</h2><p><a href=\"/static/images/2017-06-03/solr-add-core-20170603161114.png\" title=\"Solr add core\" class=\"gallery-item\"><img src=\"/static/images/2017-06-03/solr-add-core-20170603161114.png\" alt=\"Solr add core\" title=\"Solr add core\"></a></p>\n<h2 id=\"导入pdf数据\"><a href=\"#导入pdf数据\" class=\"headerlink\" title=\"导入pdf数据\"></a>导入pdf数据</h2><p><a href=\"/static/images/2017-06-03/solr-exec-data-import20170603154455.png\" title=\"Solr dataImport\" class=\"gallery-item\"><img src=\"/static/images/2017-06-03/solr-exec-data-import20170603154455.png\" alt=\"Solr dataImport\" title=\"Solr dataImport\"></a><br>##配置scame 分别添加 text,title,author,filePath,size,lastModified<br><a href=\"/static/images/2017-06-03/solr-add-field-to-schema-20170603154432.png\" title=\"Solr6 add Fields\" class=\"gallery-item\"><img src=\"/static/images/2017-06-03/solr-add-field-to-schema-20170603154432.png\" alt=\"Solr6 add Fields\" title=\"Solr6 add Fields\"></a></p>\n<h2 id=\"搜索\"><a href=\"#搜索\" class=\"headerlink\" title=\"搜索\"></a>搜索</h2><p><a href=\"/static/images/2017-06-03/solr-search-20170603154351.png\" title=\"Solr search\" class=\"gallery-item\"><img src=\"/static/images/2017-06-03/solr-search-20170603154351.png\" alt=\"Solr search\" title=\"Solr search\"></a></p>\n</div><script src=\"https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js\"></script><script>if (typeof lightGallery !== 'undefined') {\n        var options = {\n            selector: '.gallery-item'\n        };\n        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);\n        }</script>","more":"<h2 id=\"配置一个支持pdf解析的solr-core\"><a href=\"#配置一个支持pdf解析的solr-core\" class=\"headerlink\" title=\"配置一个支持pdf解析的solr core\"></a>配置一个支持pdf解析的solr core</h2><ul>\n<li>复制配置文件<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp -r  configsets/basic_configs ./mypdfconf</span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n<ul>\n<li><p>复制需要的依赖包</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp -r ../../contrib/extraction/lib ./mypdfconf/ </span><br><span class=\"line\">cp ../../dist/solr-dataimporthandler-* ./mypdfconf/lib/</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>编辑solrconfig配置文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim mypdfconf/conf/solrconfig.xml</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>添加依赖配置到94行</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">lib</span> <span class=\"attr\">dir</span>=<span class=\"string\">\"./lib\"</span> <span class=\"attr\">regex</span>=<span class=\"string\">\".*\\.jar\"</span> /&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>配置dataimport到860行</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">requestHandler</span> <span class=\"attr\">name</span>=<span class=\"string\">\"/dataimport\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"solr.DataImportHandler\"</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">lst</span> <span class=\"attr\">name</span>=<span class=\"string\">\"defaults\"</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">str</span> <span class=\"attr\">name</span>=<span class=\"string\">\"config\"</span>&gt;</span>tika-data-config.xml<span class=\"tag\">&lt;/<span class=\"name\">str</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">lst</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">requestHandler</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>配置 tika-data-config.xml</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim tika-data-config.xml</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>添加以下内容</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">dataConfig</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span>&lt;![CDATA[</span><br><span class=\"line\">        id = 1;</span><br><span class=\"line\"><span class=\"actionscript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">GenerateId</span><span class=\"params\">(row)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">            row.put(<span class=\"string\">'id'</span>, (id ++).toFixed());</span></span><br><span class=\"line\"><span class=\"actionscript\">            <span class=\"keyword\">return</span> row;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"><span class=\"actionscript\">        <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">WipOffHtml</span><span class=\"params\">(row)</span> </span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">            <span class=\"keyword\">var</span> file = row.get(<span class=\"string\">'file'</span>);</span></span><br><span class=\"line\"><span class=\"actionscript\">            row.put(<span class=\"string\">'file'</span>,file.substr(<span class=\"number\">0</span>,file.indexOf(<span class=\"string\">'.'</span>)));</span></span><br><span class=\"line\"><span class=\"actionscript\">            <span class=\"keyword\">return</span> row;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">       ]]&gt;</span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">dataSource</span> <span class=\"attr\">type</span>=<span class=\"string\">\"BinFileDataSource\"</span> /&gt;</span></span><br><span class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">document</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">entity</span>    <span class=\"attr\">name</span>=<span class=\"string\">\"files\"</span> <span class=\"attr\">dataSource</span>=<span class=\"string\">\"binary\"</span>    <span class=\"attr\">rootEntity</span>=<span class=\"string\">\"false\"</span></span></span><br><span class=\"line\"><span class=\"tag\">               <span class=\"attr\">processor</span>=<span class=\"string\">\"FileListEntityProcessor\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">baseDir</span>=<span class=\"string\">\"/tmp/pdfs\"</span> <span class=\"attr\">fileName</span>=<span class=\"string\">\".*.(doc)|(pdf)|(xls)|(ppt)|(docx)\"</span></span></span><br><span class=\"line\"><span class=\"tag\">            <span class=\"attr\">recursive</span>=<span class=\"string\">\"true\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"fileAbsolutePath\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"filePath\"</span> /&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"fileSize\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"size\"</span> /&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"fileLastModified\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"lastModified\"</span> /&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">entity</span>  <span class=\"attr\">name</span>=<span class=\"string\">\"documentImport\"</span>  <span class=\"attr\">processor</span>=<span class=\"string\">\"TikaEntityProcessor\"</span>  <span class=\"attr\">url</span>=<span class=\"string\">\"$&#123;files.fileAbsolutePath&#125;\"</span> <span class=\"attr\">format</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">transformer</span>=<span class=\"string\">\"HTMLStripTransformer,RegexTransformer,script:GenerateId\"</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"file\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"fileName\"</span>/&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span> <span class=\"attr\">column</span>=<span class=\"string\">\"id\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"id\"</span> /&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"Author\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"author\"</span> <span class=\"attr\">meta</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"title\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"title\"</span> <span class=\"attr\">meta</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">field</span>  <span class=\"attr\">column</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">name</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">stripHTML</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">regex</span>=<span class=\"string\">\"\\t|\\r|\\n|\\s\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                    <span class=\"attr\">replaceWith</span>=<span class=\"string\">\"\"</span> /&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">entity</span>&gt;</span></span><br><span class=\"line\">              <span class=\"tag\">&lt;/<span class=\"name\">entity</span>&gt;</span></span><br><span class=\"line\">           <span class=\"tag\">&lt;/<span class=\"name\">document</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dataConfig</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>添加pdf，doc文档（非扫描版）</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp ../../../../example/exampledocs/solr-word.pdf /tmp/pdfs/</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h2 id=\"添加core\"><a href=\"#添加core\" class=\"headerlink\" title=\"添加core\"></a>添加core</h2><p><a href=\"/static/images/2017-06-03/solr-add-core-20170603161114.png\" title=\"Solr add core\" class=\"gallery-item\"><img src=\"/static/images/2017-06-03/solr-add-core-20170603161114.png\" alt=\"Solr add core\" title=\"Solr add core\"></a></p>\n<h2 id=\"导入pdf数据\"><a href=\"#导入pdf数据\" class=\"headerlink\" title=\"导入pdf数据\"></a>导入pdf数据</h2><p><a href=\"/static/images/2017-06-03/solr-exec-data-import20170603154455.png\" title=\"Solr dataImport\" class=\"gallery-item\"><img src=\"/static/images/2017-06-03/solr-exec-data-import20170603154455.png\" alt=\"Solr dataImport\" title=\"Solr dataImport\"></a><br>##配置scame 分别添加 text,title,author,filePath,size,lastModified<br><a href=\"/static/images/2017-06-03/solr-add-field-to-schema-20170603154432.png\" title=\"Solr6 add Fields\" class=\"gallery-item\"><img src=\"/static/images/2017-06-03/solr-add-field-to-schema-20170603154432.png\" alt=\"Solr6 add Fields\" title=\"Solr6 add Fields\"></a></p>\n<h2 id=\"搜索\"><a href=\"#搜索\" class=\"headerlink\" title=\"搜索\"></a>搜索</h2><p><a href=\"/static/images/2017-06-03/solr-search-20170603154351.png\" title=\"Solr search\" class=\"gallery-item\"><img src=\"/static/images/2017-06-03/solr-search-20170603154351.png\" alt=\"Solr search\" title=\"Solr search\"></a></p>\n</div><script src=\"https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js\"></script><script>if (typeof lightGallery !== 'undefined') {\n        var options = {\n            selector: '.gallery-item'\n        };\n        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);\n        }</script>","categories":[{"name":"编程","path":"api/categories/编程.json"}],"tags":[{"name":"solr","path":"api/tags/solr.json"},{"name":"tika","path":"api/tags/tika.json"}]}